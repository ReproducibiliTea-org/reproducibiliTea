---
layout: default
---
{% include keys.html %}
<link rel="stylesheet" type="text/css" href="/assets/css/join-form.css"/>
<script type="text/javascript" src="/assets/js/join-form.js"></script>

<article id="signupForm">
    <section id="joinWelcome">
        <h1>1<span class="fade">/3</span> Welcome</h1>

        <p>Use this form to create a new <strong>ReproducibiliTea</strong> journal club. We assume you are here after consulting Amy, and are ready to take on the exciting challenge of running your own journal club. Once you complete the form on this page, we'll automatically add you to our list of journal clubs, create you a page on the website, initialise an OSF repository for you, and invite you to the Slack workspace.</p>
        <p class="jump"><a href="#joinSetup"><i class="fas fa-chevron-down"></i> Get ready <i class="fas fa-chevron-down"></i></a></p>

    </section>
    <div class="margin"></div>
    <section id="joinSetup">
        <h1><a href="#joinWelcome"><i class="fas fa-level-up-alt fa-flip-horizontal"></i></a> 2<span class="fade">/3</span> Get ready</h1>

        <p>To get the most out of your ReproducibiliTea club you will probably want to have accounts with the key platforms we use. The form you will fill out in Step 3 will automatically link your accounts on these platforms to our resources.</p>
        <table class="platforms">
            <thead>
            <tr>
                <th>Platform</th>
                <th>Details</th>
            </tr>
            </thead>
            <tbody>
            <tr>
                <td>
                    <a href="https://osf.io/" target="_blank">
                        <img src="https://osf.io/static/img/institutions/shields/cos-shield.png" alt="OSF Logo"><br/>
                        OSF <sup><i class="fas fa-external-link-square-alt"></i></sup></a>
                </td>
                <td>
                    <p>The Open Science Framework (OSF) provides storage for various kinds of files. We have a main <a href="https://osf.io/3qrj6/" target="_blank">ReproducibiliTea project <sup><i class="fas fa-external-link-square-alt"></i></sup></a> and each of the journal clubs have their own repository within it.</p>
                    <p> We will create a repository for your journal club automatically and make you the repository admin. You can then manage it as you see fit. But to do this we will need your OSF profile ID (a few letters and numbers looking like '3qrj6') so you will need to have <a href="https://osf.io/register" target="_blank">created an OSF account <sup><i class="fas fa-external-link-square-alt"></i></sup></a></strong> and know your profile ID . Don't worry if you can't find your ID now, we'll explain how to find it in Step 3.</p>
           
                </td>
            </tr>
            <tr>
                <td>
                    <a href="https://slack.com/" target="_blank">
                        <img src="https://cdn.brandfolder.io/5H442O3W/as/pl546j-7le8zk-4nzzs1/Slack_Mark_Web.png" alt="Slack Logo"/><br/>
                        Slack <sup><i class="fas fa-external-link-square-alt"></i></sup></a>
                </td>
                <td>
                    <p>We use Slack to manage the collective organisation of ReproducibiliTea. Whether it's for planning combined events, sharing tips on how to run the journal clubs, or good old fashioned emotional support, the Slack channel is where it happens.</p>
                    <p>We can't automatically add you to the Slack channel, but we will send you the link to join once you complete the sign up process.</p>
                </td>
            </tr>
            <tr>
                <td>
                    <a href="https://zotero.org/" target="_blank">
                        <img src="https://www.zotero.org/support/_media/logo/zotero_128x128x32.png" class="logo" alt="Zotero Logo"/><br/>
                        Zotero <sup><i class="fas fa-external-link-square-alt"></i></sup></a>
                </td>
                <td>
                    <p>Zotero is a reference manager like EndNote or Mendeley. You may already have a reference manager, but joining the Zotero group will mean you can benefit from other organisers' paper suggestions, and share your own cool papers - we are always looking for suggestions.</p>
                    <p>We'll create a folder for you automatically in our <a href="https://www.zotero.org/groups/2354006/reproducibilitea/items" target="_blank">Zotero Group Library <sup><i class="fas fa-external-link-square-alt"></i></sup></a> but <strong>to be added as a group member you need to have a <a href="https://www.zotero.org/user/register" target="_blank">Zotero account <sup><i class="fas fa-external-link-square-alt"></i></sup></a></strong>. Everyone can view the library, but only group members can add and remove papers.</p>
                    <p>Your Zotero API number is a little tricky to find, but we'll explain how you find it on the form in Step 3.</p>
                </td>
            </tr>
            </tbody>
        </table>
        <p class="jump"><a href="#joinForm"><i class="fas fa-chevron-down"></i> Sign up <i class="fas fa-chevron-down"></i></a></p>

    </section>
    <div class="margin"></div>
    <section id="joinForm">
        <h1><a href="#joinSetup"><i class="fas fa-level-up-alt fa-flip-horizontal"></i></a> 3<span class="fade">/3</span> Sign up</h1>

        <form id="newJC" onchange="checkForm(event, true)">
            <fieldset class="JC-details">
                <input type="hidden" id="jcid" name="jcid" />
                <div class="row mandatory">
                    <div class="labels">
                        <label for="name">JC Name</label>
                        <div class="label-details">
                            <p>The name of the journal club. Don't include "ReproducibiliTea" in the name - we're all "ReproducibiliTea X".</p>
                            <ul>
                                <li class="public">This will be displayed publicly.</li>
                                <li class="is-mandatory">This field is required.</li>
                                <li>This cannot match an existing journal club's name.</li>
                            </ul>
                        </div>
                    </div>
                    <input type="text" id="name" name="name" placeholder="Academia" />
                    <template id="existing-jc-names">
                        {% for jc in site.journal-clubs %}
                        <div>{{ jc.title }}</div>
                        {% endfor %}
                    </template>
                </div>

                <div class="row mandatory">
                    <div class="labels">
                        <label for="uni">Host university</label>
                        <div class="label-details">
                            <p>This is the name of the university or organisation to which the journal club belongs. Online journal clubs can give a broader name, such as their country or region, or their primary communication service.</p>
                            <ul>
                                <li class="public">This will be displayed publicly.</li>
                                <li class="is-mandatory">This field is required.</li>
                            </ul>
                        </div>
                    </div>
                    <input type="text" id="uni" name="uni" placeholder="University of Academia" />
                </div>

                <div class="row">
                    <div class="labels">
                        <label for="uniWWW">University website</label>
                        <div class="label-details">
                            <p>This is the website for the host university.</p>
                            <ul>
                                <li class="public">This will be displayed publicly.</li>
                                <li class="is-mandatory">This field is optional.</li>
                            </ul>
                        </div>
                    </div>
                    <input type="text" id="uniWWW" name="uniWWW" placeholder="https://academia.ac/" />
                </div>

                <div class="row">
                    <div class="labels">
                        <label for="www">JC website</label>
                        <div class="label-details">
                            <p>If your journal club has a website you can put it here.</p>
                            <ul>
                                <li class="public">This will be displayed publicly.</li>
                                <li class="is-mandatory">This field is optional.</li>
                            </ul>
                        </div>
                    </div>
                    <input type="text" id="www" name="www" placeholder="https://academia-rpt.github.io/" />
                </div>

                <div class="row">
                    <div class="labels">
                        <label for="twitter">JC <a href="https://twitter.com/">Twitter</a></label>
                        <div class="label-details">
                            <p>If you are going to run a Twitter account for your journal club you can put your handle here.</p>
                            <ul>
                                <li class="public">This will be displayed publicly.</li>
                                <li class="is-mandatory">This field is optional.</li>
                            </ul>
                        </div>
                    </div>
                    <input type="text" id="twitter" name="twitter" placeholder="@AcademiaRpT" />
                </div>

                <div class="row">
                    <div class="labels">
                        <label for="osf">JC <a href="https://osf.io/">OSF</a> Repository</label>
                        <div class="label-details">
                            <p>If you already have an OSF repository, and <strong>don't want us to create a new one for you</strong>, put in the OSF link here. You need only put the specific repository bit of the URL here (e.g. 'cfby7'), but you can also paste the whole URL if you like.</p>
                            <ul>
                                <li class="public">This will be displayed publicly.</li>
                                <li class="is-mandatory">This field is optional.</li>
                            </ul>
                        </div>
                    </div>
                    <input type="text" id="osf" name="osf" placeholder="https://osf.io/cfby7/" />
                </div>

                <div class="row">
                    <div class="labels">
                        <label for="signup">Signup url/email</label>
                        <div class="label-details">
                            <p>Here you can put an email address or web address (e.g. <a href="https://forms.google.com/">Google forms</a>) which people can use to sign up to your JC mailing list.</p>
                            <ul>
                                <li class="public">This will be displayed publicly.</li>
                                <li class="is-mandatory">This field is optional.</li>
                            </ul>
                        </div>
                    </div>
                    <input type="text" id="signup" name="signup" placeholder="goodScholar@academia.ac" />
                </div>

                <div class="row mandatory">
                    <div class="labels">
                        <label for="post">Postal address</label>
                        <div class="label-details">
                            <p>This is the address where we'll send the starter pack, including stickers and the famous teapot!</p>
                            <ul>
                                <li class="hidden">This will be publicly accessible via <a href="https://github.com/{{ site.github_user }}/reproducibiliTea/">the GitHub repository</a>, but not displayed on the website.</li>
                                <li class="is-mandatory">This field is required.</li>
                            </ul>
                        </div>
                    </div>
                    <textarea id="post" name="post" placeholder="Room 301,
Reproducible Research Institute,
University of Academia" onchange="geolocateAddress()"></textarea>
                </div>

                <div class="row mandatory">
                    <div class="labels">
                        <label for="country">Country</label>
                        <div class="label-details">
                            <p>The country your JC will be in. This should be the same country as the postal address given above.</p>
                            <ul>
                                <li class="public">This will be displayed publicly.</li>
                                <li class="is-mandatory">This field is required.</li>
                            </ul>
                        </div>
                    </div>
                    <select id="country" name="country">
                        <option value="Afghanistan">Afghanistan</option>
                        <option value="Åland Islands">Åland Islands</option>
                        <option value="Albania">Albania</option>
                        <option value="Algeria">Algeria</option>
                        <option value="American Samoa">American Samoa</option>
                        <option value="Andorra">Andorra</option>
                        <option value="Angola">Angola</option>
                        <option value="Anguilla">Anguilla</option>
                        <option value="Antarctica">Antarctica</option>
                        <option value="Antigua and Barbuda">Antigua and Barbuda</option>
                        <option value="Argentina">Argentina</option>
                        <option value="Armenia">Armenia</option>
                        <option value="Aruba">Aruba</option>
                        <option value="Australia">Australia</option>
                        <option value="Austria">Austria</option>
                        <option value="Azerbaijan">Azerbaijan</option>
                        <option value="Bahamas">Bahamas</option>
                        <option value="Bahrain">Bahrain</option>
                        <option value="Bangladesh">Bangladesh</option>
                        <option value="Barbados">Barbados</option>
                        <option value="Belarus">Belarus</option>
                        <option value="Belgium">Belgium</option>
                        <option value="Belize">Belize</option>
                        <option value="Benin">Benin</option>
                        <option value="Bermuda">Bermuda</option>
                        <option value="Bhutan">Bhutan</option>
                        <option value="Bolivia">Bolivia</option>
                        <option value="Bosnia and Herzegovina">Bosnia and Herzegovina</option>
                        <option value="Botswana">Botswana</option>
                        <option value="Bouvet Island">Bouvet Island</option>
                        <option value="Brazil">Brazil</option>
                        <option value="British Indian Ocean Territory">British Indian Ocean Territory</option>
                        <option value="Brunei Darussalam">Brunei Darussalam</option>
                        <option value="Bulgaria">Bulgaria</option>
                        <option value="Burkina Faso">Burkina Faso</option>
                        <option value="Burundi">Burundi</option>
                        <option value="Cambodia">Cambodia</option>
                        <option value="Cameroon">Cameroon</option>
                        <option value="Canada">Canada</option>
                        <option value="Cape Verde">Cape Verde</option>
                        <option value="Cayman Islands">Cayman Islands</option>
                        <option value="Central African Republic">Central African Republic</option>
                        <option value="Chad">Chad</option>
                        <option value="Chile">Chile</option>
                        <option value="China">China</option>
                        <option value="Christmas Island">Christmas Island</option>
                        <option value="Cocos (Keeling) Islands">Cocos (Keeling) Islands</option>
                        <option value="Colombia">Colombia</option>
                        <option value="Comoros">Comoros</option>
                        <option value="Congo">Congo</option>
                        <option value="Congo, The Democratic Republic of The">Congo, The Democratic Republic of The</option>
                        <option value="Cook Islands">Cook Islands</option>
                        <option value="Costa Rica">Costa Rica</option>
                        <option value="Cote D'ivoire">Cote D'ivoire</option>
                        <option value="Croatia">Croatia</option>
                        <option value="Cuba">Cuba</option>
                        <option value="Cyprus">Cyprus</option>
                        <option value="Czech Republic">Czech Republic</option>
                        <option value="Denmark">Denmark</option>
                        <option value="Djibouti">Djibouti</option>
                        <option value="Dominica">Dominica</option>
                        <option value="Dominican Republic">Dominican Republic</option>
                        <option value="Ecuador">Ecuador</option>
                        <option value="Egypt">Egypt</option>
                        <option value="El Salvador">El Salvador</option>
                        <option value="Equatorial Guinea">Equatorial Guinea</option>
                        <option value="Eritrea">Eritrea</option>
                        <option value="Estonia">Estonia</option>
                        <option value="Ethiopia">Ethiopia</option>
                        <option value="Falkland Islands (Malvinas)">Falkland Islands (Malvinas)</option>
                        <option value="Faroe Islands">Faroe Islands</option>
                        <option value="Fiji">Fiji</option>
                        <option value="Finland">Finland</option>
                        <option value="France">France</option>
                        <option value="French Guiana">French Guiana</option>
                        <option value="French Polynesia">French Polynesia</option>
                        <option value="French Southern Territories">French Southern Territories</option>
                        <option value="Gabon">Gabon</option>
                        <option value="Gambia">Gambia</option>
                        <option value="Georgia">Georgia</option>
                        <option value="Germany">Germany</option>
                        <option value="Ghana">Ghana</option>
                        <option value="Gibraltar">Gibraltar</option>
                        <option value="Greece">Greece</option>
                        <option value="Greenland">Greenland</option>
                        <option value="Grenada">Grenada</option>
                        <option value="Guadeloupe">Guadeloupe</option>
                        <option value="Guam">Guam</option>
                        <option value="Guatemala">Guatemala</option>
                        <option value="Guernsey">Guernsey</option>
                        <option value="Guinea">Guinea</option>
                        <option value="Guinea-bissau">Guinea-bissau</option>
                        <option value="Guyana">Guyana</option>
                        <option value="Haiti">Haiti</option>
                        <option value="Heard Island and Mcdonald Islands">Heard Island and Mcdonald Islands</option>
                        <option value="Holy See (Vatican City State)">Holy See (Vatican City State)</option>
                        <option value="Honduras">Honduras</option>
                        <option value="Hong Kong">Hong Kong</option>
                        <option value="Hungary">Hungary</option>
                        <option value="Iceland">Iceland</option>
                        <option value="India">India</option>
                        <option value="Indonesia">Indonesia</option>
                        <option value="Iran, Islamic Republic of">Iran, Islamic Republic of</option>
                        <option value="Iraq">Iraq</option>
                        <option value="Ireland">Ireland</option>
                        <option value="Isle of Man">Isle of Man</option>
                        <option value="Israel">Israel</option>
                        <option value="Italy">Italy</option>
                        <option value="Jamaica">Jamaica</option>
                        <option value="Japan">Japan</option>
                        <option value="Jersey">Jersey</option>
                        <option value="Jordan">Jordan</option>
                        <option value="Kazakhstan">Kazakhstan</option>
                        <option value="Kenya">Kenya</option>
                        <option value="Kiribati">Kiribati</option>
                        <option value="Korea, Democratic People's Republic of">Korea, Democratic People's Republic of</option>
                        <option value="Korea, Republic of">Korea, Republic of</option>
                        <option value="Kuwait">Kuwait</option>
                        <option value="Kyrgyzstan">Kyrgyzstan</option>
                        <option value="Lao People's Democratic Republic">Lao People's Democratic Republic</option>
                        <option value="Latvia">Latvia</option>
                        <option value="Lebanon">Lebanon</option>
                        <option value="Lesotho">Lesotho</option>
                        <option value="Liberia">Liberia</option>
                        <option value="Libyan Arab Jamahiriya">Libyan Arab Jamahiriya</option>
                        <option value="Liechtenstein">Liechtenstein</option>
                        <option value="Lithuania">Lithuania</option>
                        <option value="Luxembourg">Luxembourg</option>
                        <option value="Macao">Macao</option>
                        <option value="Macedonia, The Former Yugoslav Republic of">Macedonia, The Former Yugoslav Republic of</option>
                        <option value="Madagascar">Madagascar</option>
                        <option value="Malawi">Malawi</option>
                        <option value="Malaysia">Malaysia</option>
                        <option value="Maldives">Maldives</option>
                        <option value="Mali">Mali</option>
                        <option value="Malta">Malta</option>
                        <option value="Marshall Islands">Marshall Islands</option>
                        <option value="Martinique">Martinique</option>
                        <option value="Mauritania">Mauritania</option>
                        <option value="Mauritius">Mauritius</option>
                        <option value="Mayotte">Mayotte</option>
                        <option value="Mexico">Mexico</option>
                        <option value="Micronesia, Federated States of">Micronesia, Federated States of</option>
                        <option value="Moldova, Republic of">Moldova, Republic of</option>
                        <option value="Monaco">Monaco</option>
                        <option value="Mongolia">Mongolia</option>
                        <option value="Montenegro">Montenegro</option>
                        <option value="Montserrat">Montserrat</option>
                        <option value="Morocco">Morocco</option>
                        <option value="Mozambique">Mozambique</option>
                        <option value="Myanmar">Myanmar</option>
                        <option value="Namibia">Namibia</option>
                        <option value="Nauru">Nauru</option>
                        <option value="Nepal">Nepal</option>
                        <option value="Netherlands">Netherlands</option>
                        <option value="Netherlands Antilles">Netherlands Antilles</option>
                        <option value="New Caledonia">New Caledonia</option>
                        <option value="New Zealand">New Zealand</option>
                        <option value="Nicaragua">Nicaragua</option>
                        <option value="Niger">Niger</option>
                        <option value="Nigeria">Nigeria</option>
                        <option value="Niue">Niue</option>
                        <option value="Norfolk Island">Norfolk Island</option>
                        <option value="Northern Mariana Islands">Northern Mariana Islands</option>
                        <option value="Norway">Norway</option>
                        <option value="Oman">Oman</option>
                        <option value="Pakistan">Pakistan</option>
                        <option value="Palau">Palau</option>
                        <option value="Palestinian Territory, Occupied">Palestinian Territory, Occupied</option>
                        <option value="Panama">Panama</option>
                        <option value="Papua New Guinea">Papua New Guinea</option>
                        <option value="Paraguay">Paraguay</option>
                        <option value="Peru">Peru</option>
                        <option value="Philippines">Philippines</option>
                        <option value="Pitcairn">Pitcairn</option>
                        <option value="Poland">Poland</option>
                        <option value="Portugal">Portugal</option>
                        <option value="Puerto Rico">Puerto Rico</option>
                        <option value="Qatar">Qatar</option>
                        <option value="Reunion">Reunion</option>
                        <option value="Romania">Romania</option>
                        <option value="Russian Federation">Russian Federation</option>
                        <option value="Rwanda">Rwanda</option>
                        <option value="Saint Helena">Saint Helena</option>
                        <option value="Saint Kitts and Nevis">Saint Kitts and Nevis</option>
                        <option value="Saint Lucia">Saint Lucia</option>
                        <option value="Saint Pierre and Miquelon">Saint Pierre and Miquelon</option>
                        <option value="Saint Vincent and The Grenadines">Saint Vincent and The Grenadines</option>
                        <option value="Samoa">Samoa</option>
                        <option value="San Marino">San Marino</option>
                        <option value="Sao Tome and Principe">Sao Tome and Principe</option>
                        <option value="Saudi Arabia">Saudi Arabia</option>
                        <option value="Senegal">Senegal</option>
                        <option value="Serbia">Serbia</option>
                        <option value="Seychelles">Seychelles</option>
                        <option value="Sierra Leone">Sierra Leone</option>
                        <option value="Singapore">Singapore</option>
                        <option value="Slovakia">Slovakia</option>
                        <option value="Slovenia">Slovenia</option>
                        <option value="Solomon Islands">Solomon Islands</option>
                        <option value="Somalia">Somalia</option>
                        <option value="South Africa">South Africa</option>
                        <option value="South Georgia and The South Sandwich Islands">South Georgia and The South Sandwich Islands</option>
                        <option value="Spain">Spain</option>
                        <option value="Sri Lanka">Sri Lanka</option>
                        <option value="Sudan">Sudan</option>
                        <option value="Suriname">Suriname</option>
                        <option value="Svalbard and Jan Mayen">Svalbard and Jan Mayen</option>
                        <option value="Swaziland">Swaziland</option>
                        <option value="Sweden">Sweden</option>
                        <option value="Switzerland">Switzerland</option>
                        <option value="Syrian Arab Republic">Syrian Arab Republic</option>
                        <option value="Taiwan">Taiwan</option>
                        <option value="Tajikistan">Tajikistan</option>
                        <option value="Tanzania, United Republic of">Tanzania, United Republic of</option>
                        <option value="Thailand">Thailand</option>
                        <option value="Timor-leste">Timor-leste</option>
                        <option value="Togo">Togo</option>
                        <option value="Tokelau">Tokelau</option>
                        <option value="Tonga">Tonga</option>
                        <option value="Trinidad and Tobago">Trinidad and Tobago</option>
                        <option value="Tunisia">Tunisia</option>
                        <option value="Turkey">Turkey</option>
                        <option value="Turkmenistan">Turkmenistan</option>
                        <option value="Turks and Caicos Islands">Turks and Caicos Islands</option>
                        <option value="Tuvalu">Tuvalu</option>
                        <option value="Uganda">Uganda</option>
                        <option value="Ukraine">Ukraine</option>
                        <option value="United Arab Emirates">United Arab Emirates</option>
                        <option value="United Kingdom" selected="selected">United Kingdom</option>
                        <option value="United States">United States</option>
                        <option value="United States Minor Outlying Islands">United States Minor Outlying Islands</option>
                        <option value="Uruguay">Uruguay</option>
                        <option value="Uzbekistan">Uzbekistan</option>
                        <option value="Vanuatu">Vanuatu</option>
                        <option value="Venezuela">Venezuela</option>
                        <option value="Viet Nam">Viet Nam</option>
                        <option value="Virgin Islands, British">Virgin Islands, British</option>
                        <option value="Virgin Islands, U.S.">Virgin Islands, U.S.</option>
                        <option value="Wallis and Futuna">Wallis and Futuna</option>
                        <option value="Western Sahara">Western Sahara</option>
                        <option value="Yemen">Yemen</option>
                        <option value="Zambia">Zambia</option>
                        <option value="Zimbabwe">Zimbabwe</option>
                    </select>
                </div>

                <div class="row mandatory">
                    <div class="labels">
                        <label for="geolocation">Geolocation</label>
                        <div class="label-details">
                            <p>We need to locate your JC on our map. When you enter an address we try to automatically determine the geolocation from the address, but sometimes we can't. If nothing shows here, please click the icon to choose your pin location on the map.</p>
                            <ul>
                                <li class="public">This will be displayed publicly.</li>
                                <li class="is-mandatory">This field is required.</li>
                            </ul>
                        </div>
                    </div>
                    <div class="geolocation">
                        <input id="geolocation" name="geolocation" type="text" disabled placeholder="Enter Postal address above or use button >>"/>
                        <button onclick="geolocate(event)"><i class="fas fa-map-marked-alt"></i></button>
                    </div>
                </div>

                <div class="row">
                    <div class="labels">
                        <label for="description">Journal club description</label>
                        <div class="label-details">
                            <p>The description of your journal club. This will form the body of the journal club entry on this website. You may style your writing in markdown.</p>
                            <ul>
                                <li class="public">This will be displayed publicly.</li>
                                <li class="is-mandatory">This field is optional.</li>
                            </ul>
                        </div>
                    </div>
                    <textarea id="description" name="description" placeholder="This is where you can describe your journal club if you wish. You can write markdown here, and you can always update it later on GitHub.

You might want to describe what you hope to achieve, how often you plan to meet, which disciplines you are planning to cater for, etc."></textarea>
                </div>
            </fieldset>

            <fieldset class="JC-organisers">
                <legend>Organisers</legend>
                <div class="row mandatory">
                    <div class="labels">
                        <label for="lead">Lead organiser</label>
                        <div class="label-details">
                            <p>This is the name of the head of the JC. This will be the primary person we contact about general JC matters. You may use the button to add the names of additional organisers who will be listed on the website.</p>
                            <ul>
                                <li class="public">This will be displayed publicly.</li>
                                <li class="is-mandatory">This field is must contain at least the lead organiser.</li>
                            </ul>
                        </div>
                    </div>
                    <div class="organisers">
                        <input type="text" id="lead" name="lead" placeholder="Good Scholar" />
                        <button onclick="addNewEntry(event)" data-field-id="helper" data-field-placeholder="Helper"><i class="fas fa-user-plus"></i></button>
                    </div>
                </div>

                <div class="row mandatory">
                    <div class="labels">
                        <label for="email">Contact email</label>
                        <div class="label-details">
                            <p>This is the email address for the lead organiser. It can be an email for the journal club rather than a personal email if you like. We will use this for getting in touch with you about general JC stuff.</p>
                            <p>You may add additional email addresses if you like, but as long as one member of your JC gets our emails that is enough.</p>
                            <p><strong>Any email addresses listed here will be able to update the journal club details later.</strong></p>
                            <ul>
                                <li class="hidden">This will be publicly accessible via <a href="https://github.com/{{ site.github_user }}/reproducibiliTea/">the GitHub repository</a>, but not displayed on the website.</li>
                                <li class="is-mandatory">This field is required.</li>
                            </ul>
                        </div>
                    </div>
                    <div class="emails">
                        <input type="email" id="email" name="email" placeholder="goodScholar@academia.ac" />
                        <button onclick="addNewEntry(event)" data-field-id="extraEmail" data-field-placeholder="Extra email"><i class="fas fa-user-plus"></i></button>
                    </div>
                </div>

                <div class="row" id="osfUserRow">
                    <div class="labels">
                        <label for="osfUser">Lead organiser <a href="https://osf.io/">OSF</a> id</label>
                        <div class="label-details">
                            <p>This is the OSF id for the organiser we'll add as a contributor on the OSF page we'll create for your JC.</p>
                            <p>You can find your OSF id by logging in and going to your profile (click the menu in the top-right, and select '<strong>profile</strong>'), then choosing '<strong>public profile</strong>'. The second part of that URL, after the osf.io/, is your OSF id.</p>
                            <ul>
                                <li class="private">This will only be used for adding you as a contributor. It will not be saved.</li>
                                <li class="is-mandatory">This field is optional.</li>
                            </ul>
                        </div>
                    </div>
                    <input type="text" id="osfUser" name="osfUser" placeholder="a9b2z" />
                </div>

                <div class="row" id="zoteroUserRow">
                    <div class="labels">
                        <label for="zoteroUser">Lead organiser <a href="https://zotero.org/">Zotero</a> API id</label>
                        <div class="label-details">
                            <p>This is the Zotero id for the organiser we'll add to the <a href="https://www.zotero.org/groups/2354006/reproducibilitea/items">ReproducibiliTea Zotero Group Library</a> we can all use to share good papers for discussion.</p>
                            <p>You can find your Zotero API id by logging in, going to <strong>settings</strong> > <strong>Feeds/API</strong>. At the top you'll see: 'Your userID for use in API calls is ...'</p>
                            <ul>
                                <li class="private">This will only be used for adding you as a contributor. It will not be saved.</li>
                                <li class="is-mandatory">This field is optional.</li>
                            </ul>
                        </div>
                    </div>
                    <input type="text" id="zoteroUser" name="zoteroUser" placeholder="20048242" />
                </div>

            </fieldset>

            <fieldset class="submission">
                <legend>Final checks</legend>
                <div id="AuthCodeRow" class="row mandatory">
                    <div class="labels">
                        <label for="authCode">Authorization code</label>
                        <div class="label-details">
                            <p>To prevent just anyone spamming this form with new JC requests, we need you to submit the password given to you by one of the core ReproducibiliTea team.</p>
                            <ul>
                                <li class="private">This will only be used for adding you as a contributor. It will not be saved.</li>
                                <li class="is-mandatory">This field is required.</li>
                            </ul>
                        </div>
                    </div>
                    <input type="text" id="authCode" name="authCode" placeholder="????????" />
                </div>

                <div class="row mandatory">
                    <button onclick="submitForm(event)">Activate JC!</button>
                </div>
            </fieldset>
        </form>
    </section>
</article>

<section id="LoadingModal">
    <div>
        <h2>Edit journal club</h2>
        <div id="CheckToken">
            <i class="fa-hourglass fas fa-spin"></i>
            <p>Checking access token</p>
        </div>
        <div id="TokenOkay">
            <i class="fa-hourglass fas fa-spin"></i>
            <p>Preparing form for <span class="jc-name">journal club</span></p>
        </div>
        <div id="RejectToken">
            <i class="fas fa-exclamation-triangle"></i>
            <p>Access token was invalid</p>
            <p>Please check the link in your email, and if necessary request a new one from <a href="/edit-jc.html">the edit journal club page</a>.</p>
        </div>
    </div>
</section>


<script>
    /* If we're editing an existing JC, look up the existing values and use them to fill in the field values. */
    async function checkToken() {
        const gitURL = `https://api.github.com/repos/{{ site.github_user }}/reproducibiliTea/contents/_journal-clubs`;
        if(!window.jcEditToken) {
            const match = /[?&]jcEditToken=([^&]*)/g.exec(location.href);
            if (!match)
                return;
            window.jcEditToken = {token: match[1]};
        }
        if(!window.jcEditToken.token)
            return;
        document.getElementById('LoadingModal').classList.add('token-check');
        await fetch('/.netlify/functions/edit-jc_check-token', {
            method: 'POST',
                body: JSON.stringify(window.jcEditToken)
        })
            .then(r => {
                if(r.status !== 200)
                    throw new Error(`Token lookup error: server response was (${r.status}) (${r.statusText}).`);
                else
                    return r.json()
            })
            .then(token => fetch(`${gitURL}/${token.jcid}.md`, {headers: {'User-Agent': '{{ site.github_user }}'}}))
            .then(r => {
                if(r.status !== 200)
                    throw new Error(`Could not find existing GitHub file: ${r.statusText} (${r.status})`);
                else
                    return r.json();
            })
            .then(md => acceptToken(parseMD(md.content)))
            .catch(e => rejectToken(e));
    }

    /**
     * Parse a base64-encoded journal club MD file from gitHub into name-value pairs
     * @param data {string}
     * @return {object}
     */
    function parseMD(data) {
        data = atob(data);
        const match = /^---(.*)---\s*(.*)$/s.exec(data);
        if(!match)
            throw new Error('Badly formed markdown file received from GitHub.');
        const lines = match[1].split('\n');
        const pairs = lines.map(s => {
            const m = /^(.+?):\s*(.*)$/.exec(s);
            return m? {key: m[1], value: m[2]} : null;
        })
            .filter(o => o !== null);
        const out = {content: match.length >= 3? match[2] : ''};
        pairs.forEach(p => out[p.key] = p.value);
        return out;
    }
    function acceptToken(data) {
        document.getElementById('LoadingModal').classList.add('token-okay');
        const form = document.getElementById('newJC');
        // Fill in the form fields from data
        const token = document.createElement('input');
        token.type = 'hidden';
        token.value = JSON.stringify(window.jcEditToken);
        token.name = 'editToken';
        token.id = 'editToken';
        form.appendChild(token);
        if(data.title)
            form.querySelector('#name').value = data.title;
        if(data['host-organisation'])
            form.querySelector('#uni').value = data['host-organisation'];
        if(data['host-org-url'])
            form.querySelector('#uniWWW').value = data['host-org-url'];
        if(data.website)
            form.querySelector('#www').value = data.website;
        if(data.twitter)
            form.querySelector('#twitter').value = data.twitter;
        if(data.osf)
            form.querySelector('#osf').value = data.osf;
        if(data.signup)
            form.querySelector('#signup').value = data.signup;
        if(data.address) {
            const match = /^\[?(.+?)\]?$/.exec(data.address);
            if(match) {
                const addr = match[1].replace(/,\s*/g, ',\n');
                form.querySelector('#post').value = addr;
            }
        }
        if(data.geolocation) {
            const match = /^\[?(.+?)\]?$/.exec(data.geolocation);
            if(match) {
                form.querySelector('#geolocation').value = match[1];
            }
        }
        if(data.content)
            form.querySelector('#description').value = data.content;
        if(data.organisers) {
            const match = /^\[?(.+?)\]?$/.exec(data.organisers);
            if(match) {
                const organisers = match[1].split(', ');
                form.querySelector('#lead').value = organisers[0];
                let last = form.querySelector('#lead');
                for (let o = 1; o < organisers.length; o++) {
                    addNewEntry(last);
                    last = form.querySelector(`#helper${o - 1}`);
                    last.value = organisers[o];
                }
            }
        }
        if(data.contact)
            form.querySelector('#email').value = data.contact;
        if(data['additional-contact']) {
            const match = /^\[?(.+?)\]?$/.exec(data['additional-contact']);
            if(match) {
                const contacts = match[1].split(', ');
                let last = form.querySelector('#email');
                for (let c = 0; c < contacts.length; c++) {
                    addNewEntry(last);
                    last = form.querySelector(`#extraEmail${c}`);
                    last.value = contacts[c];
                }
            }
        }
        // Remove the unneded fields
        document.getElementById('AuthCodeRow').remove();
        document.getElementById('osfUserRow').remove();
        document.getElementById('zoteroUserRow').remove();
        document.querySelector('.submission button').innerHTML = "Commit changes";
        // Remove unnecessary sections
        document.getElementById('signupForm').classList.add('edit');
        // Hide the modal and let the user get on with it
        document.getElementById('LoadingModal').classList.add('token-complete');
        //window.scrollTo(window.scrollX, form.getBoundingClientRect().y);
    }
    function rejectToken(e) {
        console.warn(e);
        document.getElementById('LoadingModal').classList.add('token-reject');
    }
    checkToken();
</script>

<article id="geolocation-map">
    <h2>Drag the marker to position your Journal Club (you can zoom in!)</h2>
    <div id="geolocation-map-display"></div>
    <div class="geolocation-map-controls"><button onclick="setGeolocation(event)"><i class="fas fa-map-marker-alt"></i> Use location</button></div>
    <script id="mapAPIsource"></script>
    <script>
        {% assign key = site.APIkeys | where_exp: "k", "k[0] == 'maps'" %}
        let key = "{{ key[0][1] }}";
        document.getElementById('mapAPIsource').src = `https://maps.googleapis.com/maps/api/js?key=${key}&callback=initialize`;

        let map;
        let endMarker;
        const input = document.getElementById("geolocation");

        function initialize() {
            map = new google.maps.Map(
                document.getElementById("geolocation-map-display"),
                {
                    zoom: 1,
                    center: {lat: 0, lng: 0}
                }
                );

            const existing = input.value;
            let position = map.getCenter();
            if(existing) {
                const parse = existing.split(',');
                position = {lat: parseFloat(parse[0]), lng: parseFloat(parse[1])};
            }

            // create the marker
            endMarker = new google.maps.Marker({
                position,
                map: map,
                draggable: true,
            });

            // add an event "onDrag"
            google.maps.event.addListener(endMarker, 'dragend', function() {
                copyMarkerpositionToInput();
            });
        }

        function copyMarkerpositionToInput() {
            // get the position of the marker, and set it as the value of input
            input.value = endMarker.getPosition().lat() +','+  endMarker.getPosition().lng();
        }
    </script>
</article>
